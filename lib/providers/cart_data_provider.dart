import 'package:flutter/foundation.dart';
import '../models/cart/cart_data.dart';

const contentJson = '''{
      "allocatedOrderNumber": "1022072941",
      "code": "1022072940",
      "appliedOrderPromotions": [],
      "appliedProductPromotions": [],
      "appliedVouchers": [],
      "deliveryCost": null,
      "deliveryAddress": null,
      "deliveryMode": null,
      "entries": [
        {
          "isExcludedFromAvailabilityCheck": false,
          "basePrice": {
            "formattedValue": "€58.00",
            "value": 58,
            "currencyIso": "EUR"
          },
          "entryNumber": 0,
          "product": {
            "altText": "Women-Women-721™ High-Waisted Skinny Jeans-London Nights",
            "baseOptions": [
              {
                "selected": {
                  "displaySizeDescription": "27W X 32L"
                },
                "variantType": "PC13Product"
              },
              {
                "selected": {
                  "displaySizeDescription": null
                },
                "variantType": "PC9Product"
              }
            ],
            "baseProduct": "188820261",
            "categories": [
              {
                "code": "levi_clothing",
                "image": null,
                "url": "/clothing/c/levi_clothing"
              },
              {
                "code": "levi_clothing_women",
                "image": null,
                "url": "/clothing/women/c/levi_clothing_women"
              }
            ],
            "categoryNames": [],
            "code": "18882026102732",
            "colorName": "London Nights - Black",
            "description": null,
            "images": [
              {
                "altText": null,
                "format": "Cart_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$cart_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Cart_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$cart_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Cart_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$cart_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$minicart_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$minicart_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$minicart_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$checkout_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$checkout_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$checkout_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Swatch",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-swatch-lse.jpg?\$swatch\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$find-in-store_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$find-in-store_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/188820261-front-pdp-lse.jpg?\$find-in-store_desktop_full\$"
              }
            ],
            "maxOrderQuantity": 6,
            "merchantBadge": null,
            "minOrderQuantity": 1,
            "name": "721™ High-Waisted Skinny Jeans",
            "price": {
              "code": null,
              "currencyIso": "EUR",
              "formattedValue": "€58.00",
              "hardPrice": 58,
              "hardPriceFormattedValue": "€58.00",
              "maxQuantity": null,
              "minQuantity": null,
              "priceType": "BUY",
              "regularPrice": 115,
              "regularPriceFormattedValue": "€115.00",
              "softPrice": null,
              "softPriceFormattedValue": null,
              "value": 58
            },
            "stock": {
              "stockLevel": 1,
              "stockLevelStatus": "lowStock"
            }
          },
          "quantity": 1,
          "totalPrice": {
            "formattedValue": "€58.00",
            "value": 58
          }
        },
        {
          "isExcludedFromAvailabilityCheck": false,
          "basePrice": {
            "formattedValue": "€100.00",
            "value": 100,
            "currencyIso": "EUR"
          },
          "entryNumber": 1,
          "product": {
            "altText": "Women-Women-Mile High Super Skinny Jeans-Smoke Show",
            "baseOptions": [
              {
                "selected": {
                  "displaySizeDescription": "27W X 32L"
                },
                "variantType": "PC13Product"
              },
              {
                "selected": {
                  "displaySizeDescription": null
                },
                "variantType": "PC9Product"
              }
            ],
            "baseProduct": "227910092",
            "categories": [
              {
                "code": "levi_clothing",
                "image": null,
                "url": "/clothing/c/levi_clothing"
              },
              {
                "code": "levi_clothing_women",
                "image": null,
                "url": "/clothing/women/c/levi_clothing_women"
              }
            ],
            "categoryNames": [],
            "code": "22791009202732",
            "colorName": "Smoke Show - Grey",
            "description": null,
            "images": [
              {
                "altText": null,
                "format": "Cart_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$cart_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Cart_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$cart_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Cart_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$cart_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$minicart_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$minicart_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$minicart_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$checkout_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$checkout_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$checkout_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Swatch",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-swatch-lse.jpg?\$swatch\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$find-in-store_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$find-in-store_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910092-front-pdp-lse.jpg?\$find-in-store_desktop_full\$"
              }
            ],
            "maxOrderQuantity": 6,
            "merchantBadge": null,
            "minOrderQuantity": 1,
            "name": "Mile High Super Skinny Jeans",
            "price": {
              "code": null,
              "currencyIso": "EUR",
              "formattedValue": "€100.00",
              "hardPrice": null,
              "hardPriceFormattedValue": null,
              "maxQuantity": null,
              "minQuantity": null,
              "priceType": "BUY",
              "regularPrice": 100,
              "regularPriceFormattedValue": "€100.00",
              "softPrice": null,
              "softPriceFormattedValue": null,
              "value": 100
            },
            "stock": {
              "stockLevel": 6,
              "stockLevelStatus": "inStock"
            }
          },
          "quantity": 1,
          "totalPrice": {
            "formattedValue": "€100.00",
            "value": 100
          }
        },
        {
          "isExcludedFromAvailabilityCheck": false,
          "basePrice": {
            "formattedValue": "€100.00",
            "value": 100,
            "currencyIso": "EUR"
          },
          "entryNumber": 2,
          "product": {
            "altText": "Women-Jeans-Mile High Super Skinny Jeans-Echo Darkness",
            "baseOptions": [
              {
                "selected": {
                  "displaySizeDescription": "27W X 32L"
                },
                "variantType": "PC13Product"
              },
              {
                "selected": {
                  "displaySizeDescription": null
                },
                "variantType": "PC9Product"
              }
            ],
            "baseProduct": "227910107",
            "categories": [
              {
                "code": "levi_clothing",
                "image": null,
                "url": "/clothing/c/levi_clothing"
              },
              {
                "code": "levi_clothing_women",
                "image": null,
                "url": "/clothing/women/c/levi_clothing_women"
              },
              {
                "code": "levi_clothing_women_jeans",
                "image": null,
                "url": "/clothing/women/jeans/c/levi_clothing_women_jeans"
              }
            ],
            "categoryNames": [],
            "code": "22791010702732",
            "colorName": "Echo Darkness - Blue",
            "description": null,
            "images": [
              {
                "altText": null,
                "format": "Cart_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$cart_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Cart_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$cart_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Cart_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$cart_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$minicart_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$minicart_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Mini-cart_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$minicart_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$checkout_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$checkout_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Checkout_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$checkout_desktop_full\$"
              },
              {
                "altText": null,
                "format": "Swatch",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-swatch-lse.jpg?\$swatch\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Mobile",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$FIS_mobile_full\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Tablet",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$FIS_tablet_full\$"
              },
              {
                "altText": null,
                "format": "Find-in-store_Desktop",
                "galleryIndex": null,
                "imageType": "PRIMARY",
                "url": "https://lsco.scene7.com/is/image/lsco/levis/clothing/227910107-front-pdp-lse.jpg?\$FIS_desktop_full\$"
              }
            ],
            "maxOrderQuantity": 6,
            "merchantBadge": null,
            "minOrderQuantity": 1,
            "name": "Mile High Super Skinny Jeans",
            "price": {
              "code": null,
              "currencyIso": "EUR",
              "formattedValue": "€100.00",
              "hardPrice": null,
              "hardPriceFormattedValue": null,
              "maxQuantity": null,
              "minQuantity": null,
              "priceType": "BUY",
              "regularPrice": 100,
              "regularPriceFormattedValue": "€100.00",
              "softPrice": null,
              "softPriceFormattedValue": null,
              "value": 100
            },
            "stock": {
              "stockLevel": 6,
              "stockLevelStatus": "inStock"
            }
          },
          "quantity": 1,
          "totalPrice": {
            "formattedValue": "€100.00",
            "value": 100
          }
        }
      ],
      "guid": "412b69eb-0785-4bf3-9206-5d4c23283d51",
      "potentialOrderPromotions": [],
      "potentialProductPromotions": [],
      "subTotal": {
        "formattedValue": "€258.00"
      },
      "totalDiscounts": {
        "formattedValue": "€0.00",
        "value": 0
      },
      "totalItems": 3,
      "totalPrice": {
        "formattedValue": "€258.00",
        "value": 258,
        "currencyIso": "EUR"
      },
      "totalPriceWithTax": {
        "formattedValue": "€258.00"
      },
      "totalTax": {
        "formattedValue": "€0.00"
      },
      "totalUnitCount": 3
    }
''';

class CartDataProvider with ChangeNotifier {
  CartData cartData;
  bool _promoApplied = true;
  bool _promoError = false;
  String _promoText = '';

  bool get prmoApplied {
    return _promoApplied;
  }

  bool get promoError {
    return _promoError;
  }

  String get promoText {
    return _promoText;
  }

  Future<void> fetchCart() async {
    // final contentURL =
    //     'https://www.levi.com/omni-cms-gw-exp-api/v1/levicom/online/homepage?country=US&language=en_US&type=homepage_v2&include[]=ref__marketing_layout_v1.ref__marketing_modules_v1';
    // final data = await http.get(contentURL);

    // final Map<String, dynamic> respBody = json.decode(data.body);
    // final respModules = respBody['entries'][0]['ref__marketing_layout_v1'][0]
    //     ['ref__marketing_modules_v1'];

    // final decodedJson = json.decode(contentJson) as Map<String, dynamic>;
    // final decodedJson = json.decode(respModules) as Map<String, dynamic>;
    // _modules = MarketingModules.fromJson({'ref__marketing_modules_v1': respModules}).refMarketingModulesV1;
    cartData = CartData.fromJson(contentJson);

    await Future<void>.value(null);
    print(cartData);
    _promoError = false;
    notifyListeners();
  }

  Future<CartData> applyPromo(String text) async {
    print('Applying *** $text *** promotion');

    _promoApplied = false;
    notifyListeners();
    await Future<CartData>.delayed(Duration(seconds: 3));
    _promoApplied = true;
    _promoError = true;
    print(cartData);
    notifyListeners();
    return cartData;
  }

  void setPromoText(String value) {
    _promoText = value;
    notifyListeners();
  }
}
